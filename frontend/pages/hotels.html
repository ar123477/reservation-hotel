<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nos Hôtels - TogoHotel Manager</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="../css/style.css" rel="stylesheet">
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
        <div class="container">
            <a class="navbar-brand" href="../index.html">
                <i class="fas fa-hotel me-2"></i>TogoHotel Manager
            </a>
            <div class="collapse navbar-collapse">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="../index.html">Accueil</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" href="hotels.html">Hôtels</a>
                    </li>
                </ul>
                <div class="navbar-nav" id="authLinks">
                    <a class="nav-link" href="login.html">Connexion</a>
                    <a class="nav-link" href="signup.html">Inscription</a>
                </div>
                <div class="navbar-nav" id="userMenu" style="display: none;">
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown">
                            <i class="fas fa-user me-1"></i>
                            <span id="userName"></span>
                        </a>
                        <ul class="dropdown-menu" id="dashboardLinks">
                            <!-- Liens dynamiques selon le rôle -->
                        </ul>
                    </li>
                </div>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="hero-section">
        <div class="container">
            <div class="row">
                <div class="col-12 text-center">
                    <h1 class="display-5 fw-bold text-white mb-4">Nos Hôtels Partenaires</h1>
                    <p class="lead text-white">Découvrez les meilleurs établissements du Togo</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Filtres -->
    <section class="py-4 bg-light">
        <div class="container">
            <div class="card shadow-sm">
                <div class="card-body">
                    <div class="row g-3 align-items-end">
                        <div class="col-md-4">
                            <label for="villeFilter" class="form-label">Ville</label>
                            <select class="form-select" id="villeFilter">
                                <option value="">Toutes les villes</option>
                                <option value="Lomé">Lomé</option>
                                <option value="Kara">Kara</option>
                            </select>
                        </div>
                        <div class="col-md-4">
                            <label for="priceFilter" class="form-label">Prix maximum par nuit</label>
                            <select class="form-select" id="priceFilter">
                                <option value="">Tous les prix</option>
                                <option value="35000">35,000 FCFA</option>
                                <option value="55000">55,000 FCFA</option>
                                <option value="85000">85,000 FCFA</option>
                                <option value="150000">150,000 FCFA</option>
                            </select>
                        </div>
                        <div class="col-md-4">
                            <button class="btn btn-primary w-100" onclick="applyFilters()">
                                <i class="fas fa-filter me-2"></i>Appliquer les filtres
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Liste des Hôtels -->
    <section class="py-5">
        <div class="container">
            <div class="row" id="hotelsList">
                <!-- Les hôtels seront chargés ici par JavaScript -->
            </div>
        </div>
    </section>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="../js/auth.js"></script>
    <script src="../js/api.js"></script>
    <script src="../js/main.js"></script>
    <script>
        let allHotels = [];

        // Fonction pour générer les étoiles
        function generateStars(rating) {
            let stars = '';
            for (let i = 1; i <= 5; i++) {
                if (i <= rating) {
                    stars += '<i class="fas fa-star text-warning"></i>';
                } else {
                    stars += '<i class="far fa-star text-warning"></i>';
                }
            }
            return stars;
        }

        // Fonction pour obtenir l'image d'un hôtel
        function getHotelImage(hotelId) {
            const images = {
                1: 'https://images.unsplash.com/photo-1566073771259-6a8506099945?w=400&h=300&fit=crop',
                2: 'https://images.unsplash.com/photo-1520250497591-112f2f40a3f4?w=400&h=300&fit=crop',
                3: 'https://images.unsplash.com/photo-1551882547-ff40c63fe5fa?w=400&h=300&fit=crop',
                4: 'https://images.unsplash.com/photo-1618773928121-c32242e63f39?w=400&h=300&fit=crop'
            };
            return images[hotelId] || 'https://images.unsplash.com/photo-1566073771259-6a8506099945?w=400&h=300&fit=crop';
        }

        // Fonction pour afficher les hôtels
        function displayHotels(hotels) {
            const container = document.getElementById('hotelsList');
            container.innerHTML = '';

            if (hotels.length === 0) {
                container.innerHTML = `
                    <div class="col-12 text-center py-5">
                        <i class="fas fa-hotel fa-3x text-muted mb-3"></i>
                        <h4 class="text-muted">Aucun hôtel trouvé</h4>
                        <p class="text-muted">Aucun hôtel ne correspond à vos critères de recherche.</p>
                    </div>
                `;
                return;
            }

            hotels.forEach(hotel => {
                const hotelCard = `
                    <div class="col-md-6 col-lg-4 mb-4">
                        <div class="card hotel-card h-100">
                            <img src="${getHotelImage(hotel.id)}" class="card-img-top" alt="${hotel.nom}" style="height: 250px; object-fit: cover;">
                            <div class="card-body">
                                <h5 class="card-title">${hotel.nom}</h5>
                                <p class="card-text text-muted">
                                    <i class="fas fa-map-marker-alt text-danger me-2"></i>${hotel.ville}
                                </p>
                                <p class="card-text text-muted">
                                    <i class="fas fa-phone text-primary me-2"></i>${Utils.formatPhoneNumber(hotel.telephone)}
                                </p>
                                <div class="mb-3">
                                    ${generateStars(4)}
                                    <span class="text-muted ms-2">4.0/5</span>
                                </div>
                                <div class="d-grid gap-2">
                                    <a href="hotel-detail.html?id=${hotel.id}" class="btn btn-primary">
                                        <i class="fas fa-eye me-2"></i>Voir l'hôtel
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
                container.innerHTML += hotelCard;
            });
        }

        // Fonction pour appliquer les filtres
        function applyFilters() {
            const ville = document.getElementById('villeFilter').value;
            const prix = document.getElementById('priceFilter').value;

            let filteredHotels = allHotels;

            if (ville) {
                filteredHotels = filteredHotels.filter(hotel => hotel.ville === ville);
            }

            displayHotels(filteredHotels);
        }

        // Charger les hôtels
        async function loadHotels() {
            const container = document.getElementById('hotelsList');
            Utils.showLoading(container);

            try {
                const hotels = await API.getHotels();
                allHotels = hotels;
                displayHotels(hotels);
            } catch (error) {
                console.error('Erreur lors du chargement des hôtels:', error);
                Utils.showError(container, 'Impossible de charger la liste des hôtels. Veuillez réessayer.');
            }
        }

        // Initialisation
        document.addEventListener('DOMContentLoaded', function() {
            Auth.updateNavigation();
            loadHotels();
        });
    </script>
</body>
</html>